/*! For license information please see index.js.LICENSE.txt */
var Index;(()=>{var e={192(){!function(e,t){"use strict";"function"!=typeof e.CustomEvent&&(e.CustomEvent=function(e,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var r=t.createEvent("CustomEvent");return r.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),r},e.CustomEvent.prototype=e.Event.prototype),t.addEventListener("touchstart",function(e){"true"!==e.target.getAttribute("data-swipe-ignore")&&(l=e.target,i=Date.now(),n=e.touches[0].clientX,r=e.touches[0].clientY,o=0,s=0)},!1),t.addEventListener("touchmove",function(e){if(n&&r){var t=e.touches[0].clientX,i=e.touches[0].clientY;o=n-t,s=r-i}},!1),t.addEventListener("touchend",function(e){if(l===e.target){var t=parseInt(l.getAttribute("data-swipe-threshold")||"20",10),a=parseInt(l.getAttribute("data-swipe-timeout")||"500",10),c=Date.now()-i,d="";Math.abs(o)>Math.abs(s)?Math.abs(o)>t&&c<a&&(d=o>0?"swiped-left":"swiped-right"):Math.abs(s)>t&&c<a&&(d=s>0?"swiped-up":"swiped-down"),""!==d&&l.dispatchEvent(new CustomEvent(d,{bubbles:!0,cancelable:!0})),n=null,r=null,i=null}},!1);var n=null,r=null,o=null,s=null,i=null,l=null}(window,document)},633(e,t,n){"use strict";n.d(t,{A:()=>l});var r=n(601),o=n.n(r),s=n(314),i=n.n(s)()(o());i.push([e.id,'body {\n  background: #f9f8ee;\n  font-family: "Clear Sans", "Helvetica Neue", Arial, sans-serif;\n  width: 500px;\n  margin: 0 auto;\n  overflow: hidden;\n}\n.header {\n  color: #776e65;\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  margin: 2px;\n}\n.header > * {\n  padding: 2px;\n}\n.header > .score {\n  border: solid 1px #8f7a66;\n  border-radius: 3px;\n  box-sizing: border-box;\n  font-size: 18px;\n  padding: 10px 20px;\n  text-align: center;\n}\n.game-name {\n  font-size: 80px;\n  font-weight: bold;\n  flex-grow: 1;\n}\n.buttons > button {\n  background: #8f7a66;\n  color: #f9f6f2;\n  font-size: 18px;\n  font-weight: bold;\n  border: 1px solid #8f7a66;\n  border-radius: 3px;\n  padding: 10px 20px;\n  text-align: center;\n}\n.buttons > button:hover {\n  background: #776e65;\n}\n.container {\n  display: table;\n  background: #a49281;\n  border: 8px solid #a49281;\n  border-radius: 14px;\n  margin: 0 auto;\n  position: relative;\n}\n.row {\n  display: table-row;\n}\n.cell {\n  display: table-cell;\n  background: #bdb09f;\n  color: #776e65;\n  font-family: "Clear Sans", "Helvetica Neue", Arial, sans-serif;\n  font-weight: bold;\n  font-size: 40px;\n  text-align: center;\n  vertical-align: middle;\n  border: 8px solid #a49281;\n  border-radius: 14px;\n  width: 100px;\n  height: 100px;\n}\n.cell-floating {\n  position: absolute;\n  top: -9999px;\n  left: -9999px;\n  transition: top 0.3s, left 0.3s;\n  animation-name: popup;\n  animation-duration: 0.3s;\n}\n.cell-content {\n  position: relative;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.cell-2 {\n  background: #eee4da;\n}\n.cell-4 {\n  background: #ede0c8;\n}\n.cell-8 {\n  background: #f2b179;\n  color: #f9f6f2;\n}\n.cell-16 {\n  background: #f59563;\n  color: #f9f6f2;\n}\n.cell-32 {\n  background: #f67c5f;\n  color: #f9f6f2;\n}\n.cell-64 {\n  background: #f65e3b;\n  color: #f9f6f2;\n}\n.cell-128 {\n  background: #edcf72;\n  color: #f9f6f2;\n}\n.cell-256 {\n  background: #edcc61;\n  color: #f9f6f2;\n}\n.cell-512 {\n  background: #edc850;\n  color: #f9f6f2;\n}\n.cell-1024 {\n  background: #edc53f;\n  color: #f9f6f2;\n}\n.cell-2048 {\n  background: #edc22e;\n  color: #f9f6f2;\n}\n.cell-more {\n  background: #3c3a32;\n  color: #f9f6f2;\n}\n@keyframes popup {\n  from {\n    transform: scale(0);\n  }\n  to {\n    transform: scale(1);\n  }\n}\n',""]);const l=i},314(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,o,s){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(i[a]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&i[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},601(e){"use strict";e.exports=function(e){return e[1]}},998(e,t,n){"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(72),o=n.n(r),s=n(825),i=n.n(s),l=n(659),a=n.n(l),c=n(56),d=n.n(c),u=n(540),h=n.n(u),f=n(113),m=n.n(f),p=n(633),v={};v.styleTagTransform=m(),v.setAttributes=d(),v.insert=a().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=h(),o()(p.A,v);const g=p.A&&p.A.locals?p.A.locals:void 0},72(e){"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},i=[],l=0;l<e.length;l++){var a=e[l],c=r.base?a[0]+r.base:a[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var h=n(u),f={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==h)t[h].references++,t[h].updater(f);else{var m=o(f,r);r.byIndex=l,t.splice(l,0,{identifier:u,updater:m,references:1})}i.push(u)}return i}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var s=r(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<s.length;i++){var l=n(s[i]);t[l].references--}for(var a=r(e,o),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=a}}},659(e){"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56(e,t,n){"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},74(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cell=void 0;class n{constructor(e){if(this._value=e,!this.isPowerOfTwo(e))throw new Error(`The '${e}' value is not allowed.`)}static empty(){return new n(null)}canMergeWith(e){return!this.isEmpty&&this.value===e.value}mergeWith(e){if(!this.canMergeWith(e))throw new Error(`${this._value} and ${e._value} cannot be merged.`);return new n(this.value+e.value)}isPowerOfTwo(e){return 0!==e&&!(e&e-1)}get value(){return this._value}get isEmpty(){return null==this.value}}t.Cell=n},507(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellCreatedEventArgs=void 0;const r=n(957);class o extends r.EventArgs{constructor(e,t){super(),this.newCell=e,this.position=t}}t.CellCreatedEventArgs=o},829(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellMergedEventArgs=void 0;const r=n(957);class o extends r.EventArgs{constructor(e,t,n){super(),this.newCell=e,this.from=t,this.to=n}}t.CellMergedEventArgs=o},174(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellMovedEventArgs=void 0;const r=n(957);class o extends r.EventArgs{constructor(e,t){super(),this.from=e,this.to=t}}t.CellMovedEventArgs=o},428(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0,t.Event=class{constructor(){this._handlers=[]}on(e){this._handlers.push(e)}raise(e){this._handlers.forEach(t=>t(e))}}},957(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventArgs=void 0,t.EventArgs=class{}},484(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const r=n(74),o=n(428),s=n(957),i=n(850);t.Game=class{constructor(){this._gameUpdated=new o.Event,this._score=0,this._finished=!1,this._grid=new i.Grid,this._grid.addSubsriptionToCellMerged(e=>this._score+=e.newCell.value)}addSubsriptionToGameUpdated(e){if(!e)throw new Error("The handler is undefined.");this._gameUpdated.on(e)}newGame(){this._score=0,this._finished=!1,this._grid.initializeEmpty(),this._grid.addNewCell(),this._grid.addNewCell(),this.raiseGameUpdated()}loadGame(e){this._score=e&&e.score||0,this._finished=e&&e.finished||!1;const t=e.cells.map(e=>e.map(e=>new r.Cell(e)));this._grid.initializeFrom(t),this.raiseGameUpdated()}move(e){this._finished||this._grid.move(e)&&(this._grid.hasMoves()||(this._finished=!0))}raiseGameUpdated(){this._gameUpdated&&this._gameUpdated.raise(new s.EventArgs)}get cells(){return this._grid.cells}get grid(){return this._grid}get score(){return this._score}get finished(){return this._finished}}},850(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Grid=void 0;const r=n(74),o=n(507),s=n(829),i=n(174),l=n(428),a=n(722);class c{constructor(){this._cellMoved=new l.Event,this._cellMerged=new l.Event,this._cellCreated=new l.Event,this.initializeEmpty()}initializeFrom(e){if(e.length!==c.rows)throw new Error(`The row length should be equal to ${c.rows}.`);for(const t of e)if(t.length!==c.columns)throw new Error(`The column length should be equal to ${c.columns}.`);this._cells=e}initializeEmpty(){this._cells=this.generateEmptyField()}addSubsriptionToCellMoved(e){if(!e)throw new Error("The handler is undefined.");this._cellMoved.on(e)}addSubsriptionToCellMerged(e){if(!e)throw new Error("The handler is undefined.");this._cellMerged.on(e)}addSubscriptionToCellCreated(e){if(!e)throw new Error("The handler is undefined.");this._cellCreated.on(e)}addNewCell(){const e=this.generatePosition(),t=this.generateNewCell();this._cells[e.row][e.column]=t,this.raiseCellCreated(t,e)}hasMoves(){if(this._cells.some(e=>e.some(e=>e.isEmpty)))return!0;for(let e=0;e<c.rows-1;e++)for(let t=0;t<c.columns-1;t++){const n=this.getCell(e,t),r=this.getCell(e,t+1),o=this.getCell(e+1,t);if(r&&n.canMergeWith(r))return!0;if(o&&n.canMergeWith(o))return!0}return!1}move(e){let t=!1;return e===a.MoveDirection.Up?t=this.moveUp():e===a.MoveDirection.Down?t=this.moveDown():e===a.MoveDirection.Left?t=this.moveLeft():e===a.MoveDirection.Right&&(t=this.moveRight()),t&&this.addNewCell(),t}merge(e,t){let n=!1,o=this.getCell(e.row,e.column);for(let s=e.row+t[0],i=e.column+t[1];s>=0&&s<c.rows&&i>=0&&i<c.columns;s+=t[0],i+=t[1]){const t=this.getCell(s,i);if(!t.isEmpty){if(!o.isEmpty){if(o.canMergeWith(t)){const l=o.mergeWith(t);return this._cells[e.row][e.column]=l,this._cells[s][i]=r.Cell.empty(),this.raiseCellMerged(l,{row:s,column:i},e),n=!0,n}return n}this.swapCells({row:s,column:i},e),this.raiseCellMoved({row:s,column:i},e),o=t,n=!0}}return n}moveUp(){let e=!1;for(let t=0;t<c.columns;t++)for(let n=0;n<c.rows;n++)this.merge({row:n,column:t},[1,0])&&(e=!0);return e}moveDown(){let e=!1;for(let t=0;t<c.columns;t++)for(let n=c.rows-1;n>=0;n--)this.merge({row:n,column:t},[-1,0])&&(e=!0);return e}moveLeft(){let e=!1;for(let t=0;t<c.rows;t++)for(let n=0;n<c.columns;n++)this.merge({row:t,column:n},[0,1])&&(e=!0);return e}moveRight(){let e=!1;for(let t=0;t<c.rows;t++)for(let n=c.columns-1;n>=0;n--)this.merge({row:t,column:n},[0,-1])&&(e=!0);return e}swapCells(e,t){const n=this._cells[e.row][e.column];this._cells[e.row][e.column]=this._cells[t.row][t.column],this._cells[t.row][t.column]=n}generateEmptyField(){const e=[];for(let t=0;t<c.rows;t++){e[t]=[];for(let n=0;n<c.columns;n++)e[t][n]=r.Cell.empty()}return e}generateNewCell(){const e=[2,2,2,2,4],t=e[Math.floor(Math.random()*e.length)];return new r.Cell(t)}generatePosition(){const e=this.getEmptyCellPositions();return e[Math.floor(Math.random()*e.length)]}getEmptyCellPositions(){const e=[];for(let t=0;t<c.rows;t++)for(let n=0;n<c.columns;n++)this.getCell(t,n).isEmpty&&e.push({column:n,row:t});return e}getCell(e,t){if(e<0||e>=c.rows)throw new Error("The row index is invalid.");if(t<0||t>=c.columns)throw new Error("The column index is invalid.");return this._cells[e][t]}raiseCellMoved(e,t){this._cellMoved&&this._cellMoved.raise(new i.CellMovedEventArgs(e,t))}raiseCellMerged(e,t,n){this._cellMerged&&this._cellMerged.raise(new s.CellMergedEventArgs(e,t,n))}raiseCellCreated(e,t){this._cellCreated&&this._cellCreated.raise(new o.CellCreatedEventArgs(e,t))}get cells(){return this._cells}}t.Grid=c,c.rows=4,c.columns=4},722(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MoveDirection=void 0,function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(n||(t.MoveDirection=n={}))},977(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;const r=n(850),o=n(722);t.Renderer=class{constructor(e,t){if(this.game=e,this.storage=t,!e)throw new Error("The game is undefined.");this._scoreElement=document.getElementById("score_value"),this._container=document.getElementsByClassName("container")[0],this.game.addSubsriptionToGameUpdated(e=>this.renderGame(e)),this.game.grid.addSubsriptionToCellMoved(e=>this.renderMove(e)),this.game.grid.addSubscriptionToCellCreated(e=>this.renderCellCreated(e)),this.game.grid.addSubsriptionToCellMerged(e=>this.renderCellMerged(e)),document.addEventListener("keyup",t=>{"ArrowUp"===t.key?e.move(o.MoveDirection.Up):"ArrowDown"===t.key?e.move(o.MoveDirection.Down):"ArrowLeft"===t.key?e.move(o.MoveDirection.Left):"ArrowRight"===t.key&&e.move(o.MoveDirection.Right)}),document.addEventListener("swiped-up",()=>{e.move(o.MoveDirection.Up)}),document.addEventListener("swiped-down",()=>{e.move(o.MoveDirection.Down)}),document.addEventListener("swiped-left",()=>{e.move(o.MoveDirection.Left)}),document.addEventListener("swiped-right",()=>{e.move(o.MoveDirection.Right)}),document.addEventListener("keydown",e=>{"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.preventDefault()})}renderGame(e){this.removeElementsByClass("cell-floating");for(let e=0;e<r.Grid.rows;e++)for(let t=0;t<r.Grid.columns;t++){const n=this.game.cells[e][t];n.isEmpty||this.createDivCell(this._container,n,{row:e,column:t})}this._scoreElement.innerText=this.game.score.toString(),this.storage.save(this.game)}renderCellCreated(e){const{newCell:t,position:n}=e;t.isEmpty||(this.createDivCell(this._container,t,n),this.storage.save(this.game))}renderMove(e){const{from:t,to:n}=e,r=this.getDivCell(t);r&&(r.setAttribute("data-row",n.row.toString()),r.setAttribute("data-column",n.column.toString()),r.style.top=116*n.row+"px",r.style.left=116*n.column+"px",this.storage.save(this.game))}renderCellMerged(e){const{newCell:t,from:n,to:r}=e;if(t.isEmpty)return;const o=this.getDivCell(n);o.parentNode.removeChild(o);const s=this.getDivCell(r);s.parentNode.removeChild(s),this.createDivCell(this._container,t,r),this._scoreElement.innerText=this.game.score.toString(),this.storage.save(this.game)}createDivCell(e,t,n){const r=document.createElement("div");r.classList.add("cell","cell-floating"),t.value>2048?r.classList.add("cell-more"):r.classList.add(`cell-${t.value}`),r.setAttribute("data-row",n.row.toString()),r.setAttribute("data-column",n.column.toString()),r.style.top=116*n.row+"px",r.style.left=116*n.column+"px";const o=document.createElement("div");o.classList.add("cell-content"),o.innerText=`${t.value}`,r.appendChild(o),e.appendChild(r)}removeElementsByClass(e){const t=document.getElementsByClassName(e);for(;t.length>0;)t[0].parentNode.removeChild(t[0])}getDivCell(e){return document.querySelector(`[data-row='${e.row}'][data-column='${e.column}']`)}}},653(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0,t.Storage=class{constructor(){this.key="data"}save(e){const t={cells:e.cells.map(e=>e.map(e=>e.value)),finished:e.finished,score:e.score};localStorage.setItem(this.key,JSON.stringify(t))}restore(e){const t=localStorage.getItem(this.key);if(!t)return;const n=JSON.parse(t);e.loadGame(n)}hasSaves(){return!!localStorage.getItem(this.key)}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};(()=>{"use strict";var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.newGameClick=function(){i.newGame()};const t=n(484),o=n(977),s=n(653);n(192),n(998);const i=new t.Game,l=new s.Storage;new o.Renderer(i,l),l.hasSaves()?l.restore(i):i.newGame()})(),Index=r})();